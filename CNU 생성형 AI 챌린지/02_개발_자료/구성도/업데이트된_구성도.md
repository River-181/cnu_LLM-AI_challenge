## UniBuddy 구성도 (v2)

제공된 자료를 바탕으로 시스템의 기술적 구조와 서비스 기능 흐름을 명확히 구분하여 다이어그램을 재작성했습니다.

### 1. 시스템 구성도 (Technical Architecture)

- **설명:** 실제 구현 시의 기술 스택과 데이터 흐름, 외부 시스템과의 연동 방식을 구체적으로 보여주는 다이어그램입니다. API 게이트웨이, 오케스트레이터, 데이터베이스, LLM 서비스 간의 상호작용을 중심으로 표현합니다.

```mermaid
flowchart LR
    subgraph 사용자 [UniBuddy 클라이언트]
        A["웹/앱"] -->|JWT| B["API 게이트웨이 (FastAPI)"]
    end

    B --> C["오케스트레이터 / 라우터"]
    C --> F["LLM 서비스\n(가드레일/프롬프트 템플릿)"]
    C --> D[_("벡터 DB: Chroma")]
    C --> E[_("관계형 DB: PostgreSQL")]

    E <-->|ETL/CDC| G["학내 시스템\nLMS · 국제교류본부 · 상담센터"]
    D <--> F

    classDef dashed stroke-dasharray:5 5;
    class F dashed;
```

### 2. 서비스 구성도 (Service Flow)

- **설명:** 사용자 관점에서 UniBuddy 서버가 어떤 기능(대화, 감정분석, 번역, 추천)들로 구성되어 있으며, 각 기능이 어떤 데이터베이스 및 외부 시스템과 상호작용하는지를 중심으로 표현한 다이어그램입니다.

```mermaid
flowchart TD
    subgraph "사용자"
        A1["웹 / 모바일 앱"]
    end

    subgraph "UniBuddy 서버"
        B1["중앙 서버 (API)"]
        subgraph "AI 기능"
            C1["대화·요약 모델"]
            C2["감정 분석 모델"]
            C3["번역 모델"]
            C4["맞춤 추천 엔진"]
        end
        D1[_("정보 검색용 DB")]
        D2[_("사용자 데이터 DB")]
    end

    subgraph "외부 연동"
        E1["학내 시스템 (LMS·강의자료)"]
        E2["상담센터"]
        E3["외부 번역 API (선택)"]
    end

    A1 --> B1
    B1 --> C1 & C2 & C3 & C4
    C1 -- "정보 검색" --> D1
    C4 -- "정보 조회" --> D1
    B1 -- "데이터 저장/관리" --> D2
    C3 -- "필요시 사용" --> E3
    B1 -- "주기적 연동" --> E1
```

```